#!/usr/bin/env python3
from concurrent.futures import ThreadPoolExecutor
from concurrent.futures import as_completed

import requests


def execute_request(domain_to_query):
    try:
        response = requests.get("https://" + domain_to_query, timeout=5)
        if 200 <= response.status_code < 400:
            print("Found working domain: https://" + domain_to_query)
            with open("verified_domains.txt", mode="a") as verified_domains_file:
                verified_domains_file.write(domain_to_query + "\n")
    except Exception:
        pass


print("Reading domain list...")
with open("domains.txt", mode="r+") as domains_file:
    domains = domains_file.read().splitlines()
    print("Executing requests...")
    with ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(execute_request, domain) for domain in domains]
        results = [future.result() for future in as_completed(futures)]
